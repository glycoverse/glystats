% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cor.R
\name{gly_cor}
\alias{gly_cor}
\title{Correlation Analysis for Glycomics and Glycoproteomics Data}
\usage{
gly_cor(
  exp,
  on = "variable",
  method = "pearson",
  p_adj_method = "BH",
  return_raw = FALSE,
  ...
)
}
\arguments{
\item{exp}{A \code{glyexp::experiment()} object containing expression matrix and sample information.}

\item{on}{A character string specifying what to correlate. Either "variable" (default) to correlate
variables/features, or "sample" to correlate samples/observations.}

\item{method}{A character string indicating which correlation coefficient is to be computed.
One of "pearson" (default) or "spearman". Note: "kendall" is not supported by Hmisc::rcorr.}

\item{p_adj_method}{A character string specifying the method to adjust p-values.
See \code{p.adjust.methods} for available methods. Default is "BH".
If NULL, no adjustment is performed.}

\item{return_raw}{A logical value. If FALSE (default), returns processed tibble results.
If TRUE, returns raw rcorr object.}

\item{...}{Additional arguments passed to \code{Hmisc::rcorr()}.}
}
\value{
A tibble with correlation results (when return_raw = FALSE):
\itemize{
\item First column: First element of the pair (variable1/sample1)
\item Second column: Second element of the pair (variable2/sample2)
\item \code{cor}: Correlation coefficient
\item \code{p_value}: Raw p-value
\item \code{p_adj}: Adjusted p-value (if p_adj_method is not NULL)
When return_raw = TRUE, returns the raw rcorr object.
}
}
\description{
Perform pairwise correlation analysis on variables or samples in the expression data.
The function calculates correlation coefficients and p-values for all pairs,
with optional multiple testing correction.
}
\details{
The function performs log2 transformation on the expression data (log2(x + 1)) before
correlation analysis. When \code{on = "variable"} (default), correlations are calculated between
variables across samples. When \code{on = "sample"}, correlations are calculated between
samples across variables.

\strong{Correlation Calculation:}
Correlation coefficients and p-values are calculated using \code{Hmisc::rcorr()} which is
more efficient than pairwise \code{stats::cor.test()} calls.

\strong{Multiple Testing Correction:}
P-values are adjusted for multiple testing using the method specified by \code{p_adj_method}.
}
\section{Required packages}{

This function requires the \code{Hmisc} package for efficient correlation calculation.
}

\seealso{
\code{\link[Hmisc:rcorr]{Hmisc::rcorr()}}, \code{\link[stats:cor]{stats::cor()}}
}
